' Диаграмма деятельности
@startuml
|Пользователь|
start
:Вставляет карту в POS-терминал;

|POS-терминал|
:Формирует запрос на оплату;
:Отправляет запрос в Платежную систему;

|Платежная система|
:Получает запрос;
:Отправляет запрос на проверку баланса;

|Банк пользователя|
:Проверяет баланс и валидность карты;

if (Средств достаточно?) then (Да)
  :Блокирует сумму;
  :Подтверждает списание;

  |Платежная система|
  :Отправляет запрос на зачисление средств;

  |Банк магазина|
  :Зачисляет сумму на счёт магазина;

  |Платежная система|
  :Отправляет подтверждение в POS-терминал;

  |POS-терминал|
  :Печатает чек;

  |Пользователь|
  :Получает подтверждение и чек;
else (Нет)
  |Банк пользователя|
  :Отклоняет операцию;

  |Платежная система|
  :Отправляет отказ в POS-терминал;

  |POS-терминал|
  :Выводит сообщение об ошибке;

  |Пользователь|
  :Получает сообщение об ошибке;
endif

stop
@enduml
